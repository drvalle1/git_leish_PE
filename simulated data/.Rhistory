rm(list=ls(all=TRUE))
set.seed(1)
setwd('U:\\anaia\\derived data')
dist=read.csv('matriz distancia.csv',as.is=T)
rownames(dist)=dist$X
ind=which(colnames(dist)=='X')
dist=dist[,-ind]
dat=read.csv('derived incidence.csv',as.is=T)
ind=which(colnames(dat)=='X')
dat1=dat[,-ind]
nloc=nrow(dat1)
nanos=ncol(dat1)
#get covariates
setwd('U:\\anaia\\derived data\\covs')
z=list.files()
ind=grep('a1_',z); z1=z[ind]; z1
wmat=list()
for (i in 1:length(z1)){
tmp=read.csv(z1[i],as.is=T)
wmat[[i]]=tmp
}
#get covariates for detection probability
xmat=matrix(0,nloc,nanos)
colnames(xmat)=paste0('x',7:17)
xmat[,paste0('x',15:17)]=1
xmat=cbind(1,as.numeric(xmat)) #add 1's for intercept
#get regression parameters
alpha=rep(0,length(wmat)+1+1) #for intercept and for invasion pressure
alpha[1]=-0.4; alpha[3:6]=runif(4,min=-1,max=1)
alpha[length(alpha)]=1
betas=c(-0.4,1)
rm(list=ls(all=TRUE))
set.seed(1)
setwd('U:\\anaia\\derived data')
dist=read.csv('matriz distancia.csv',as.is=T)
rownames(dist)=dist$X
ind=which(colnames(dist)=='X')
dist=dist[,-ind]
diag(dist)=NA
dat=read.csv('derived incidence.csv',as.is=T)
ind=which(colnames(dat)=='X')
dat1=dat[,-ind]
nloc=nrow(dat1)
nanos=ncol(dat1)
#get covariates
setwd('U:\\anaia\\derived data\\covs')
z=list.files()
ind=grep('a1_',z); z1=z[ind]; z1
wmat=list()
for (i in 1:length(z1)){
tmp=read.csv(z1[i],as.is=T)
wmat[[i]]=tmp
}
#get covariates for detection probability
xmat=matrix(0,nloc,nanos)
colnames(xmat)=paste0('x',7:17)
xmat[,paste0('x',15:17)]=1
xmat=cbind(1,as.numeric(xmat)) #add 1's for intercept
#get regression parameters
alpha=rep(0,length(wmat)+1+1) #for intercept and for invasion pressure
alpha[1]=-0.4; alpha[3:6]=runif(4,min=-1,max=1)
alpha[length(alpha)]=1
betas=c(-0.4,1)
#get latent u's and z's
z1=u1=matrix(NA,nloc,nanos)
z1[,1]=rbinom(nloc,size=1,prob=0.1)
i=1
i=2
tmp=matrix(z1[,i-1],nloc,nloc,byrow=T)
tmp[1:5,1:5]
soma=apply(dist,1,sum,na.rm=T)
soma1=matrix(soma,nloc,nloc,byrow=T)
soma1[1:5,1:5]
rm(list=ls(all=TRUE))
set.seed(1)
setwd('U:\\anaia\\derived data')
dist=read.csv('matriz distancia.csv',as.is=T)
rownames(dist)=dist$X
ind=which(colnames(dist)=='X')
dist=dist[,-ind]
diag(dist)=NA
dat=read.csv('derived incidence.csv',as.is=T)
ind=which(colnames(dat)=='X')
dat1=dat[,-ind]
nloc=nrow(dat1)
nanos=ncol(dat1)
#get covariates
setwd('U:\\anaia\\derived data\\covs')
z=list.files()
ind=grep('a1_',z); z1=z[ind]; z1
ncov=length(z1)
wmat=list()
for (i in 1:ncov){
tmp=read.csv(z1[i],as.is=T)
wmat[[i]]=tmp
}
#get covariates for detection probability
xmat=matrix(0,nloc,nanos)
colnames(xmat)=paste0('x',7:17)
xmat[,paste0('x',15:17)]=1
xmat=cbind(1,as.numeric(xmat)) #add 1's for intercept
#get regression parameters
alpha=rep(0,length(wmat)+1+1) #for intercept and for invasion pressure
alpha[1]=-0.4; alpha[3:6]=runif(4,min=-1,max=1)
alpha[length(alpha)]=1
betas=c(-0.4,1)
#get latent u's and z's
z1=u1=matrix(NA,nloc,nanos)
z1[,1]=rbinom(nloc,size=1,prob=0.1)
soma=apply(dist,1,sum,na.rm=T)
soma1=matrix(soma,nloc,nloc,byrow=T)
i=1
IP=(1/dist)*matrix(z1[,i-1],nloc,nloc,byrow=T)/soma1
IP=(1/dist)*matrix(z1[,i-1],nloc,nloc,byrow=T)/soma1
#get other covariates
media=alpha[1]+alpha[length(alpha)]*IP
for (j in 1:ncov){
media=media+alpha[j+1]*wmat[[j]][,i]
}
dim(media)
#get invasion pressure
IP=(1/dist)*matrix(z1[,i-1],nloc,nloc,byrow=T)/soma1
IP1=apply(IP,1,sum,na.rm=T)
#get other covariates
media=alpha[1]+alpha[length(alpha)]*IP1
for (j in 1:ncov){
media=media+alpha[j+1]*wmat[[j]][,i]
}
dim(media)
length(media)
rm(list=ls(all=TRUE))
set.seed(1)
setwd('U:\\anaia\\derived data')
dist=read.csv('matriz distancia.csv',as.is=T)
rownames(dist)=dist$X
ind=which(colnames(dist)=='X')
dist=dist[,-ind]
diag(dist)=NA
dat=read.csv('derived incidence.csv',as.is=T)
ind=which(colnames(dat)=='X')
dat1=dat[,-ind]
nloc=nrow(dat1)
nanos=ncol(dat1)
#get covariates
setwd('U:\\anaia\\derived data\\covs')
z=list.files()
ind=grep('a1_',z); z1=z[ind]; z1
ncov=length(z1)
wmat=list()
for (i in 1:ncov){
tmp=read.csv(z1[i],as.is=T)
wmat[[i]]=tmp
}
#get covariates for detection probability
xmat=matrix(0,nloc,nanos)
colnames(xmat)=paste0('x',7:17)
xmat[,paste0('x',15:17)]=1
xmat=cbind(1,as.numeric(xmat)) #add 1's for intercept
#get regression parameters
alpha=rep(0,length(wmat)+1+1) #for intercept and for invasion pressure
alpha[1]=-0.4; alpha[3:6]=runif(4,min=-1,max=1)
alpha[length(alpha)]=1
betas=c(-0.4,1)
#get latent u's and z's
z1=u1=matrix(NA,nloc,nanos)
z1[,1]=rbinom(nloc,size=1,prob=0.1)
soma=apply(dist,1,sum,na.rm=T)
soma1=matrix(soma,nloc,nloc,byrow=T)
for (i in 2:nanos){
#get invasion pressure
IP=(1/dist)*matrix(z1[,i-1],nloc,nloc,byrow=T)/soma1
IP1=apply(IP,1,sum,na.rm=T)
#get other covariates
media=alpha[1]+alpha[length(alpha)]*IP1
for (j in 1:ncov){
media=media+alpha[j+1]*wmat[[j]][,i]
}
u1[,i]=rnorm(nloc,mean=media,sd=1)
z1[,i]=ifelse(u1[,i]>0,1,0)
}
u1[1:5,1:5]
hist(IP1)
hist(u1)
for (i in 2:nanos){
cond=z1[,i-1]==1
z1[cond,i:nanos]=1
}
image(z)
image(z1)
logit.p=xmat%*%betas
p=exp(logit.p)/(1+exp(logit.p)); hist(p)
p1=matrix(p,nloc,nanos)
y=rbinom(nloc*nanos,size=1,prob=p1*z)
y1=matrix(y,nloc,nanos)
image(y1)
#export results
setwd('U:\\anaia\\simulated data')
write.csv(y1,'simulated data.csv',row.names=F)
rm(list=ls(all=TRUE))
set.seed(1)
setwd('U:\\anaia\\derived data')
dist=read.csv('matriz distancia.csv',as.is=T)
rownames(dist)=dist$X
ind=which(colnames(dist)=='X')
dist=dist[,-ind]
diag(dist)=NA
dat=read.csv('derived incidence.csv',as.is=T)
ind=which(colnames(dat)=='X')
dat1=dat[,-ind]
nloc=nrow(dat1)
nanos=ncol(dat1)
#get covariates
setwd('U:\\anaia\\derived data\\covs')
z=list.files()
ind=grep('a1_',z); z1=z[ind]; z1
ncov=length(z1)
wmat=list()
for (i in 1:ncov){
tmp=read.csv(z1[i],as.is=T)
wmat[[i]]=tmp
}
#get covariates for detection probability
xmat=matrix(0,nloc,nanos)
colnames(xmat)=paste0('x',7:17)
xmat[,paste0('x',15:17)]=1
xmat=cbind(1,as.numeric(xmat)) #add 1's for intercept
#get regression parameters
alpha=rep(0,length(wmat)+1+1) #for intercept and for invasion pressure
alpha[1]=-0.4; alpha[3:6]=runif(4,min=-1,max=1)
alpha[length(alpha)]=1
betas=c(-0.4,1)
#get latent u's and z's
z1=u1=matrix(NA,nloc,nanos)
z1[,1]=rbinom(nloc,size=1,prob=0.1)
soma=apply(dist,1,sum,na.rm=T)
soma1=matrix(soma,nloc,nloc,byrow=T)
for (i in 2:nanos){
#get invasion pressure
IP=(1/dist)*matrix(z1[,i-1],nloc,nloc,byrow=T)/soma1
IP1=apply(IP,1,sum,na.rm=T)
#get other covariates
media=alpha[1]+alpha[length(alpha)]*IP1
for (j in 1:ncov){
media=media+alpha[j+1]*wmat[[j]][,i]
}
u1[,i]=rnorm(nloc,mean=media,sd=1)
z1[,i]=ifelse(u1[,i]>0,1,0)
}
#once a z=1 for a given location, then that location is always invaded
for (i in 2:nanos){
cond=z1[,i-1]==1
z1[cond,i:nanos]=1
}
image(z1)
logit.p=xmat%*%betas
p=exp(logit.p)/(1+exp(logit.p)); hist(p)
p1=matrix(p,nloc,nanos)
y=rbinom(nloc*nanos,size=1,prob=p1*z1)
y1=matrix(y,nloc,nanos)
image(y1)
#export results
setwd('U:\\anaia\\simulated data')
write.csv(y1,'simulated data.csv',row.names=F)
rm(list=ls(all=TRUE))
set.seed(1)
setwd('U:\\anaia\\derived data')
dist=read.csv('matriz distancia.csv',as.is=T)
rownames(dist)=dist$X
ind=which(colnames(dist)=='X')
dist=dist[,-ind]
diag(dist)=NA
dat=read.csv('derived incidence.csv',as.is=T)
ind=which(colnames(dat)=='X')
dat1=dat[,-ind]
nloc=nrow(dat1)
nanos=ncol(dat1)
#get covariates
setwd('U:\\anaia\\derived data\\covs')
z=list.files()
ind=grep('a1_',z); z1=z[ind]; z1
ncov=length(z1)
wmat=list()
for (i in 1:ncov){
tmp=read.csv(z1[i],as.is=T)
wmat[[i]]=tmp
}
#get covariates for detection probability
xmat=matrix(0,nloc,nanos)
colnames(xmat)=paste0('x',7:17)
xmat[,paste0('x',15:17)]=1
xmat=cbind(1,as.numeric(xmat)) #add 1's for intercept
#get regression parameters
alpha=rep(0,length(wmat)+1+1) #for intercept and for invasion pressure
alpha[1]=-0.4; alpha[3:6]=seq(from=-1,to=1,length.out=4)
alpha[length(alpha)]=1
betas=c(-0.4,1)
#get latent u's and z's
z1=u1=matrix(NA,nloc,nanos)
z1[,1]=rbinom(nloc,size=1,prob=0.1)
soma=apply(dist,1,sum,na.rm=T)
soma1=matrix(soma,nloc,nloc,byrow=T)
for (i in 2:nanos){
#get invasion pressure
IP=(1/dist)*matrix(z1[,i-1],nloc,nloc,byrow=T)/soma1
IP1=apply(IP,1,sum,na.rm=T)
#get other covariates
media=alpha[1]+alpha[length(alpha)]*IP1
for (j in 1:ncov){
media=media+alpha[j+1]*wmat[[j]][,i]
}
u1[,i]=rnorm(nloc,mean=media,sd=1)
z1[,i]=ifelse(u1[,i]>0,1,0)
}
#once a z=1 for a given location, then that location is always invaded
for (i in 2:nanos){
cond=z1[,i-1]==1
z1[cond,i:nanos]=1
}
image(z1)
#detection probability
logit.p=xmat%*%betas
p=exp(logit.p)/(1+exp(logit.p)); hist(p)
p1=matrix(p,nloc,nanos)
y=rbinom(nloc*nanos,size=1,prob=p1*z1)
y1=matrix(y,nloc,nanos)
image(y1)
#export results
setwd('U:\\anaia\\simulated data')
write.csv(y1,'simulated data.csv',row.names=F)
write.csv(z1,'simulated status.csv',row.names=F)
write.csv(u1,'simulated latent u.csv',row.names=F)
alpha
